<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.19.0.final using JasperReports Library version 6.19.0-646c68931cebf1a58bc65c4359d1f0ca223c5e94  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Certificate" pageWidth="595" pageHeight="842" columnWidth="595" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" uuid="df08f51a-4931-4448-84ca-93bec6383b85">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Dione.jrdax"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.unit." value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageHeight" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.pageWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.topMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.bottomMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.leftMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.rightMargin" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnWidth" value="pixel"/>
	<property name="com.jaspersoft.studio.unit.columnSpacing" value="pixel"/>
	<style name="ColoredField">
		<conditionalStyle>
			<conditionExpression><![CDATA["Dark".equals($P{certTextColor})]]></conditionExpression>
			<style forecolor="#000000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA["Light".equals($P{certTextColor})]]></conditionExpression>
			<style forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="ColoredLine">
		<conditionalStyle>
			<conditionExpression><![CDATA["Dark".equals($P{certTextColor})]]></conditionExpression>
			<style forecolor="#000000"/>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA["Light".equals($P{certTextColor})]]></conditionExpression>
			<style forecolor="#FFFFFF"/>
		</conditionalStyle>
	</style>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.0" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Transparent">
		<conditionalStyle>
			<conditionExpression><![CDATA["Dark".equals($P{certTextColor})]]></conditionExpression>
			<style>
				<box>
					<topPen lineWidth="0.5" lineColor="#000000"/>
					<leftPen lineWidth="0.5" lineColor="#000000"/>
					<bottomPen lineWidth="0.5" lineColor="#000000"/>
					<rightPen lineWidth="0.5" lineColor="#000000"/>
				</box>
			</style>
		</conditionalStyle>
		<conditionalStyle>
			<conditionExpression><![CDATA["Light".equals($P{certTextColor})]]></conditionExpression>
			<style>
				<box>
					<topPen lineWidth="0.5" lineColor="#FFFFFF"/>
					<leftPen lineWidth="0.5" lineColor="#FFFFFF"/>
					<bottomPen lineWidth="0.5" lineColor="#FFFFFF"/>
					<rightPen lineWidth="0.5" lineColor="#FFFFFF"/>
				</box>
			</style>
		</conditionalStyle>
	</style>
	<subDataset name="Dataset_h" uuid="c090d755-5596-49aa-98be-1fddb3437f14">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Dione.jrdax"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<parameter name="participantUuid" class="java.lang.String"/>
		<parameter name="bg" class="java.lang.String"/>
		<parameter name="certTextColor" class="java.lang.String"/>
		<queryString>
			<![CDATA[SELECT 
	s.name AS station,
	CAST(ROUND(cp.distance) AS CHAR) AS distance,
	CASE cts.startType WHEN 'rfid' THEN CAST(cts.chiptime AS CHAR) ELSE CAST(gts.gunTime AS CHAR) END AS raceTiming
FROM racetiming.timeRecordsManualFirst t
INNER JOIN racetiming.participant p ON p.id = t.participantId
INNER JOIN racetiming.event e ON e.id = p.eventId
INNER JOIN racetiming.checkpointMapping cp ON cp.id = t.checkpointMappingId AND cp.eventId = p.eventId
INNER JOIN racetiming.station s ON s.id = cp.stationId
LEFT JOIN racetiming.calculateChipTimeByStation cts ON cts.participantId = p.id AND cts.campaignId = e.campaignId AND cts.eventId = p.eventId AND cts.checkpointMappingId = cp.id
LEFT JOIN racetiming.calculateGunTimeByStation gts ON gts.participantId = p.id AND gts.campaignId = e.campaignId AND gts.eventId = p.eventId AND gts.checkpointMappingId = cp.id
WHERE p.uuid = $P{participantUuid}
ORDER BY s.orderNum, s.id
LIMIT 1000 OFFSET 1]]>
		</queryString>
		<field name="station" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="name"/>
			<property name="com.jaspersoft.studio.field.label" value="station"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="station"/>
		</field>
		<field name="distance" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="distance"/>
			<property name="com.jaspersoft.studio.field.label" value="distance"/>
		</field>
		<field name="raceTiming" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.name" value="raceTiming"/>
			<property name="com.jaspersoft.studio.field.label" value="raceTiming"/>
		</field>
	</subDataset>
	<parameter name="bg" class="java.lang.String"/>
	<parameter name="runner" class="java.lang.String"/>
	<parameter name="event" class="java.lang.String"/>
	<parameter name="gunTime" class="java.lang.String"/>
	<parameter name="chipTime" class="java.lang.String"/>
	<parameter name="participantUuid" class="java.lang.String"/>
	<parameter name="certTextColor" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT 
	CONCAT(orun.rankRunner, ' of ', orun.totalRunner) AS overallRank,
	CONCAT(grun.rankRunner, ' of ', grun.totalRunner) AS genderRank,
	CONCAT(agrun.rankGenderRunner, ' of ', agrun.totalGenderRunner) AS ageRank
FROM racetiming.participant a
LEFT JOIN racetiming.overallRank orun ON orun.participantId = a.id AND orun.eventId = a.eventId
LEFT JOIN racetiming.genderRank grun ON grun.participantId = a.id AND grun.eventId = a.eventId
LEFT JOIN racetiming.ageGroupRank agrun ON agrun.participantId = a.id AND agrun.eventId = a.eventId
WHERE a.uuid = $P{participantUuid}]]>
	</queryString>
	<field name="overallRank" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="overallRank"/>
		<property name="com.jaspersoft.studio.field.label" value="overallRank"/>
	</field>
	<field name="genderRank" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="genderRank"/>
		<property name="com.jaspersoft.studio.field.label" value="genderRank"/>
	</field>
	<field name="ageRank" class="java.lang.String">
		<property name="com.jaspersoft.studio.field.name" value="ageRank"/>
		<property name="com.jaspersoft.studio.field.label" value="ageRank"/>
	</field>
	<background>
		<band height="842" splitType="Stretch">
			<property name="com.jaspersoft.studio.unit.height" value="px"/>
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle" onErrorType="Blank">
				<reportElement x="0" y="0" width="595" height="842" isPrintWhenDetailOverflows="true" uuid="d090b6d9-0fb2-4bdd-a4ef-bc0ca175a308">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<imageExpression><![CDATA[$P{bg}]]></imageExpression>
			</image>
		</band>
	</background>
	<detail>
		<band height="842" splitType="Stretch">
			<staticText>
				<reportElement style="ColoredField" x="0" y="200" width="594" height="50" uuid="b869058c-c7a7-4714-97b2-06ba7b641b65">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="Tahoma" size="34" isBold="true"/>
				</textElement>
				<text><![CDATA[Finisher Certificate]]></text>
			</staticText>
			<staticText>
				<reportElement style="ColoredField" x="0" y="236" width="594" height="25" uuid="27cc5236-51ce-4418-9766-f12b11735600">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font fontName="Tahoma" size="19" isBold="true"/>
				</textElement>
				<text><![CDATA[We wish to congratulate]]></text>
			</staticText>
			<staticText>
				<reportElement style="ColoredField" x="349" y="480" width="90" height="32" uuid="fadb737e-897f-4b6f-b9ea-92b9c682ba8a">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[Overall]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" mode="Transparent" x="429" y="480" width="90" height="32" uuid="5a8f7799-666c-4697-acec-05e6a3d791dd">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box rightPadding="0"/>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{overallRank}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" mode="Transparent" x="0" y="261" width="594" height="89" uuid="d360e23f-6a6c-4059-8196-dea3b77647b4">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="34" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{runner}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" x="47" y="350" width="500" height="60" uuid="1c84d3b3-3d21-4885-93ab-de9910d17afb">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="18" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA["has completed " + $P{event} + " with an official time of"]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" x="0" y="410" width="594" height="70" uuid="46114980-76f5-4d0e-9604-53699c88dbdd">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Tahoma" size="50" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{chipTime}]]></textFieldExpression>
			</textField>
			<componentElement>
				<reportElement style="Table_TD" mode="Transparent" x="70" y="495" width="240" height="24" uuid="b4eaf713-8a78-41fe-9243-ce75f4e007ad">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.table.style.table_header" value="Table_TH"/>
					<property name="com.jaspersoft.studio.table.style.column_header" value="Table_CH"/>
					<property name="com.jaspersoft.studio.table.style.detail" value="Table_TD"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="Dataset_h" uuid="7e8a4709-c9ef-4e0e-b49e-9945863482d1">
						<datasetParameter name="participantUuid">
							<datasetParameterExpression><![CDATA[$P{participantUuid}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="bg">
							<datasetParameterExpression><![CDATA[$P{bg}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="certTextColor">
							<datasetParameterExpression><![CDATA[$P{certTextColor}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="140" uuid="6fceaac1-6cbb-4915-9eb3-b40a396eeb79">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:detailCell height="24">
							<textField isBlankWhenNull="true">
								<reportElement style="Table_TD" mode="Transparent" x="0" y="0" width="140" height="24" uuid="d2b9af38-2934-4374-b44b-ed5a5ca4708e"/>
								<box topPadding="2" leftPadding="5" bottomPadding="2" rightPadding="5">
									<pen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Bottom" markup="html">
									<font fontName="Tahoma" size="16" isBold="false"/>
								</textElement>
								<textFieldExpression><![CDATA["<font color='" + ($P{certTextColor}.equals("Light") ? "#FFFFFF" : "#000000") + "'>" + 
    ($F{distance} == null ? $F{station} : $F{station} + " (" + $F{distance} + " KM)") + 
    "</font>"]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="100" uuid="47fe3d48-ed6d-4dca-9204-fbd21f2e14d8">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:detailCell height="24">
							<textField isBlankWhenNull="true">
								<reportElement style="Table_TD" mode="Transparent" x="0" y="0" width="100" height="24" uuid="fcc85771-0302-4ed9-827a-f6fe2c25130e"/>
								<box topPadding="2" leftPadding="5" bottomPadding="2" rightPadding="5">
									<pen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Center" verticalAlignment="Bottom" markup="html">
									<font fontName="Tahoma" size="16" isBold="false"/>
								</textElement>
								<textFieldExpression><![CDATA["<font color='" + ($P{certTextColor}.equals("Light") ? "#FFFFFF" :  "#000000" ) + "'>" +  ($F{raceTiming} == null ? "" : $F{raceTiming}) + "</font>"]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
			<staticText>
				<reportElement style="ColoredField" x="349" y="512" width="90" height="32" uuid="9287904a-74e8-4fa0-9170-3c31a86716fa">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[Gender]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" mode="Transparent" x="429" y="512" width="90" height="32" uuid="055d597d-c9e1-45b0-a73c-4b977772d1b4">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box rightPadding="0"/>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{genderRank}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="ColoredField" x="349" y="544" width="90" height="32" uuid="7f0353f2-87d8-4958-b0b5-7e489a7a859f">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[Age Group]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" mode="Transparent" x="429" y="544" width="90" height="32" uuid="9f40e721-b5ec-4fdb-93ff-5fdbd06b5512">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box rightPadding="0"/>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ageRank}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="ColoredField" x="349" y="576" width="90" height="32" uuid="9cfed1bc-af21-4306-bb1a-b40683ec60a4">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
				</reportElement>
				<textElement textAlignment="Left" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="15" isBold="true"/>
				</textElement>
				<text><![CDATA[Gun Time]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="ColoredField" mode="Transparent" x="429" y="576" width="90" height="32" uuid="c6d98cf9-f6a6-4ab6-964e-dc336b107e98">
					<property name="com.jaspersoft.studio.unit.height" value="px"/>
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
				<box rightPadding="0"/>
				<textElement textAlignment="Right" verticalAlignment="Bottom">
					<font fontName="Tahoma" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{gunTime}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement style="ColoredLine" x="349" y="515" width="180" height="1" uuid="5635c02c-4f46-4b78-9640-bda06f2a10c4">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
			</line>
			<line>
				<reportElement style="ColoredLine" x="349" y="547" width="180" height="1" uuid="67e277bb-c9d8-4c19-95ed-1984ac715fcd">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
			</line>
			<line>
				<reportElement style="ColoredLine" x="349" y="579" width="180" height="1" uuid="5cfb869c-212b-4a1a-8418-4c6fb4c83c61">
					<property name="com.jaspersoft.studio.unit.width" value="px"/>
				</reportElement>
			</line>
			<line>
				<reportElement style="ColoredLine" x="349" y="611" width="180" height="1" uuid="d398687c-08c8-4277-a73c-e9fba48f8d39"/>
			</line>
		</band>
	</detail>
</jasperReport>
